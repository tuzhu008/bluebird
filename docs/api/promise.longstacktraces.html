<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
 <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href='http://fonts.googleapis.com/css?family=Raleway:400,300,200,700,500,100,800,600,900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" />
    <title>Promise.longStackTraces | bluebird</title>
    <meta name="description" content="Bluebird is a fully featured JavaScript promises library with unmatched performance.">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link rel="stylesheet" href="/bluebird_cn/css/mono-blue.css" type='text/css' />
    <link rel="stylesheet" href="/bluebird_cn/css/hover-min.css" media="all">
    <link rel="stylesheet" href="/bluebird_cn/css/main.css">
    <link rel="canonical" href="https://tuzhu008.github.io/bluebird_cn/docs/api/promise.longstacktraces.html">
    <link rel="icon" href="/bluebird_cn/img/favicon.png" type="image/png" />
  </head>

  <body>

    <nav class="navbar" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

                <a href="/" class="title">
                    <img src="/bluebird_cn/img/libbblog_v3.png" class="hidden-xs" alt="bluebird logo" />

                    <span class="tagline">bluebird</span>
                </a>
            </div>
            <div id="navbar" class="navbar-collapse navbar-bluebird navbar-right collapse">
                <ul class="nav navbar-nav bb-nav">
                    

                    <li class=""><a href="/bluebird_cn/docs/api-reference.html">API</a></li>
                    <li class="active"><a href="/bluebird_cn/docs/getting-started.html">文档</a></li>
                    <li class=""><a href="/bluebird_cn/docs/support.html">支持</a></li>
                    <li class=""><a href="/bluebird_cn/docs/install.html">安装</a></li>
                    <li><a href="https://github.com/petkaantonov/bluebird/">Github</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>

   <div class="container">
      <div class="row">
        <div class="col-sm-3">
            <ul class="nav left-nav">
                <li><a href="/bluebird_cn/docs/getting-started.html">开始</a></li>
                <li><a href="/bluebird_cn/docs/features.html">特性</a></li>
                <li><a href="/bluebird_cn/docs/changelog.html">更新日志</a></li>
                <li><a href="/bluebird_cn/docs/api-reference.html"><strong>API 参考</strong></a></li>
                <li><a href="/bluebird_cn/docs/new-in-bluebird-3.html"><strong>New in 3.0</strong></a></li>
                <li><a href="/bluebird_cn/docs/warning-explanations.html">警告说明</a></li>
                <li><a href="/bluebird_cn/docs/error-explanations.html">错误说明</a></li>
                <li><a href="/bluebird_cn/docs/contribute.html">贡献</a></li>
                <li><a href="/bluebird_cn/docs/benchmarks.html">Benchmarks</a></li>
                <li><a href="/bluebird_cn/docs/deprecated-apis.html">弃用的 API</a></li>
                <li><a href="/bluebird_cn/docs/download-api-reference.html">下载 API 参考</a></li>
                <li><hr></li>
                <li>Why?
                    <ul class="nav nav-child">
                        <li><a href="/bluebird_cn/docs/why-promises.html">Why Promises?</a></li>
                        <li><a href="/bluebird_cn/docs/why-bluebird.html">Why bluebird?</a></li>
                        <li><a href="/bluebird_cn/docs/why-performance.html">Why Performance?</a></li>
                        <li><a href="/bluebird_cn/docs/what-about-generators.html">What About Generators?</a></li>
                    </ul>
                </li>
                <li><hr></li>
                <li>
                    教程
                    <ul class="nav nav-child">
                        <li><a href="/bluebird_cn/docs/async-dialogs.html">Async Dialogs</a></li>
                    </ul>
                </li>
                <li><hr></li>
                <li>
                    指南
                    <ul class="nav nav-child">
                        <li><a href="/bluebird_cn/docs/beginners-guide.html">初学者指南</a></li>
                        <li><a href="/bluebird_cn/docs/anti-patterns.html">Anti-patterns</a></li>
                        <li><a href="/bluebird_cn/docs/working-with-callbacks.html">使用回调</a></li>
                        <li><a href="/bluebird_cn/docs/coming-from-other-languages.html">来自其他语言</a></li>
                        <li><a href="/bluebird_cn/docs/coming-from-other-libraries.html">来自其他库</a></li>
                    </ul>
                </li>
                <li><hr></li>
                <li>
                    <div class="supporters">
                        <div class="reaktor supporter">
                            <a href="https://reaktor.com">
                                <img src="/bluebird_cn/img/supportlogo.png" alt="Supported by reaktor" title="Supported by Reaktor">
                            </a>
                        </div>
                    </div>
                </li>

            </ul>
        </div>
        <div class="col-sm-9">
            
            <div class="post-info">
                <a href="https://github.com/tuzhu008/bluebird_cn/edit/master/docs/docs/api/promise.longstacktraces.md">
                    <i class="fa fa-edit"></i>
                    编辑此页</a>
                <br>
                <i>更新于 02 Jan 2018</i>
            </div>
            <div class="clearfix"></div>
            
            <div class="post">
  <article class="post-content">
    <p><a href='/bluebird_cn/docs/api-reference.html' title=''>← Back To API Reference</a>
<div class="api-code-section"><markdown></p>
            <h2>
                <a class="header-anchor"
                    name="promise.longstacktraces"
                    aria-hidden="true"
                    href="#promise.longstacktraces"><i class="fa fa-link"></i></a>
                ~~Promise.longStackTraces~~
            </h2>

<p>This method is deprecated. Use <a href='/docs/api/promise.config.html' title=''>Promise.config</a> instead.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="nb">Promise</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
  <span class="nx">longStackTraces</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">})</span>
</code></pre></div>
<hr>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="nb">Promise</span><span class="p">.</span><span class="nx">longStackTraces</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">undefined</span>
</code></pre></div>
<p>Call this right after the library is loaded to enable long stack traces. Long stack traces cannot be disabled after being enabled, and cannot be enabled after promises have already been created. Long stack traces imply a substantial performance penalty, around 4-5x for throughput and 0.5x for latency.</p>

<p>Long stack traces are enabled by default in the debug build.</p>

<p>To enable them in all instances of bluebird in node.js, use the environment variable <code>BLUEBIRD_DEBUG</code>:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>BLUEBIRD_DEBUG=1 node server.js
</code></pre></div>
<p>Setting the environment variable <code>NODE_ENV</code> to <code>&quot;development&quot;</code> also automatically enables long stack traces.</p>

<p>You should enabled long stack traces if you want better debugging experience. For example:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="nb">Promise</span><span class="p">.</span><span class="nx">longStackTraces</span><span class="p">();</span>
<span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="nx">outer</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="nx">inner</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="nx">evenMoreInner</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">a</span><span class="p">.</span><span class="nx">b</span><span class="p">.</span><span class="nx">c</span><span class="p">.</span><span class="nx">d</span><span class="p">()</span>
        <span class="p">}).</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span> <span class="nx">catcher</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">stack</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">});</span>
</code></pre></div>
<p>Gives</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>ReferenceError: a is not defined
    at evenMoreInner (&lt;anonymous&gt;:6:13)
From previous event:
    at inner (&lt;anonymous&gt;:5:24)
From previous event:
    at outer (&lt;anonymous&gt;:4:20)
From previous event:
    at &lt;anonymous&gt;:3:9
    at Object.InjectedScript._evaluateOn (&lt;anonymous&gt;:581:39)
    at Object.InjectedScript._evaluateAndWrap (&lt;anonymous&gt;:540:52)
    at Object.InjectedScript.evaluate (&lt;anonymous&gt;:459:21)
</code></pre></div>
<p>While with long stack traces disabled, you would get:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>ReferenceError: a is not defined
    at evenMoreInner (&lt;anonymous&gt;:6:13)
    at tryCatch1 (&lt;anonymous&gt;:41:19)
    at Promise$_resolvePromise [as _resolvePromise] (&lt;anonymous&gt;:1739:13)
    at Promise$_resolveLast [as _resolveLast] (&lt;anonymous&gt;:1520:14)
    at Async$_consumeFunctionBuffer [as _consumeFunctionBuffer] (&lt;anonymous&gt;:560:33)
    at Async$consumeFunctionBuffer (&lt;anonymous&gt;:515:14)
    at MutationObserver.Promise$_Deferred (&lt;anonymous&gt;:433:17)
</code></pre></div>
<p>On client side, long stack traces currently only work in recent Firefoxes, Chrome and Internet Explorer 10+.
</markdown></div></p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_title = "Promise.longStackTraces";
    var disqus_shortname = "bluebirdjs";
    var disqus_identifier = "disqus-id-promise.longstacktraces";
    
    (function() {
        var dsq = document.createElement("script"); dsq.type = "text/javascript"; dsq.async = true;
        dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
        (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  </article>
</div>

        </div>
      </div>
  </div>
    <footer>
      <div class="container">
        <p style="text-align:center">本站翻译自 <a href='https://github.com/petkaantonov/bluebird/'>bluebird</a></p>
      </div>
    </footer>
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="//cdn.jsdelivr.net/bluebird/3.5.1/bluebird.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-46253177-1', 'auto');
      ga('send', 'pageview');

    </script>
</body>

</html>
